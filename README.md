# RecordClassifier / Классификация записей по набору правил

**Консольная программа для автоматической классификации записей на основе заданных правил**

---

## Оглавление

- [О проекте](#-о-проекте)
- [Возможности](#-возможности)
- [Архитектура](#-архитектура)
- [Установка и запуск](#-установка-и-запуск)
- [Формат входных данных](#-формат-входных-данных)
- [Примеры использования](#-примеры-использования)
- [Обработка ошибок](#-обработка-ошибок)
- [Тестирование](#-тестирование)
- [Документация](#-документация)
- [Авторы](#-авторы)

---

## О проекте

**RecordClassifier** — консольное приложение для классификации записей по набору правил. Программа анализирует объекты с различными свойствами и автоматически распределяет их по классам в соответствии с заданными критериями.

### Назначение

Программа предназначена для:

- Автоматической классификации объектов по заданным признакам
- Проверки корректности входных данных
- Формирования структурированных отчетов о классификации
- Обработки больших объемов данных (поддержка до 1000+ записей)

### Области применения

- Классификация товаров и продукции
- Категоризация данных в базах данных
- Автоматическая обработка структурированной информации
- Валидация и фильтрация данных

---

## Возможности

### Функциональные возможности

- **Парсинг входных данных** — чтение и разбор файлов `items.txt` и `rules.txt`
- **Валидация данных** — проверка синтаксиса, типов и уникальности свойств
- **Классификация** — сопоставление записей с правилами четырех типов
- **Генерация отчетов** — вывод результатов на экран и в файл `output.txt`
- **Обработка ошибок** — детальные сообщения при некорректных входных данных

### Поддерживаемые типы правил

| Тип правила      | Описание                           | Пример                              |
| ---------------- | ---------------------------------- | ----------------------------------- |
| `HAS_PROPERTY`   | Наличие свойства с заданным именем | `has property "doors"`              |
| `PROPERTY_SIZE`  | Количество значений свойства       | `property "wheels" has 2 values`    |
| `CONTAINS_VALUE` | Наличие конкретного значения       | `property "color" contains value 2` |
| `EQUALS_EXACTLY` | Полное совпадение массива значений | `property "seats" = [40]`           |

---

##  Архитектура

### Структура проекта

```
FilteringRecords/
├── Header Files/
│   ├── Classifier.h         # Логика классификации
│   ├── ClassRule.h          # Структура правил классификации
│   ├── DataCheckResult.h    # Результаты валидации
│   ├── Error.h              # Обработка ошибок
│   ├── Matching.h           # Сопоставление записей и правил
│   ├── Parser.h             # Парсинг входных файлов
│   ├── Property.h           # Структура свойств
│   ├── Record.h             # Структура записей
│   ├── Rule.h               # Типы правил
│   └── Validation.h         # Валидация данных
│
├── Source Files/
│   ├── Classifier.cpp       # Реализация классификации
│   ├── Error.cpp            # Реализация обработки ошибок
│   ├── main.cpp             # Точка входа программы
│   ├── Match.cpp            # Реализация сопоставления
│   ├── Parser.cpp           # Реализация парсера
│   ├── Record.cpp           # Реализация работы с записями
│   └── Validation.cpp       # Реализация валидации
│
├── images/
│   ├── uml-class-diagram.png
│   ├── function-call-diagram.png
│   └── data-flow-diagram.png
│
└── FilteringRecordsTests/   # Unit-тесты (45 тестов)
```

### Основные структуры данных

#### Property (Свойство)

```cpp
struct Property {
    std::string name;           // Имя свойства
    std::vector<int> values;    // Массив целочисленных значений
};
```

#### Record (Запись)

```cpp
struct Record {
    std::string name;                           // Имя записи
    std::map<std::string, Property> properties; // Словарь свойств
};
```

#### Rule (Правило)

```cpp
enum RuleType {
    HAS_PROPERTY,      // Проверка наличия свойства
    PROPERTY_SIZE,     // Проверка количества значений
    CONTAINS_VALUE,    // Проверка наличия конкретного значения
    EQUALS_EXACTLY     // Проверка полного совпадения
};

struct Rule {
    RuleType type;                      // Тип правила
    std::string propertyName;           // Имя свойства
    int expectedSize;                   // Ожидаемое количество (для PROPERTY_SIZE)
    int expectedValue;                  // Ожидаемое значение (для CONTAINS_VALUE)
    std::vector<int> expectedExactValues; // Эталонный массив (для EQUALS_EXACTLY)
};
```

#### ClassRule (Класс с правилами)

```cpp
struct ClassRule {
    std::string className;      // Имя класса
    std::vector<Rule> rules;    // Список правил
};
```

### UML-диаграмма классов

![UML Class Diagram](images/uml-class-diagram.png)

### Диаграмма вызовов функций

![Function Call Diagram](images/function-call-diagram.png)

### Диаграмма потоков данных

![Data Flow Diagram](images/data-flow-diagram.png)

---

## Установка и запуск

### Требования

**Аппаратные требования:**

- Процессор: Intel Core i3 или выше
- ОЗУ: 4 ГБ минимум

**Программное обеспечение:**

- Операционная система: Windows 10/11
- Компилятор: Microsoft Visual Studio 2019 или выше
- Стандарт C++: C++17

### Компиляция

#### Через Visual Studio

1. Откройте решение `FilteringRecords.sln` в Visual Studio 2019
2. Выберите конфигурацию **Release** или **Debug**
3. Нажмите **Build → Build Solution** (Ctrl+Shift+B)
4. Исполняемый файл появится в папке `x64/Release/` или `x64/Debug/`

#### Через командную строку

```bash
# С использованием g++ (MinGW)
g++ -std=c++17 -O2 -o RecordClassifier.exe main.cpp Parser.cpp Validation.cpp Classifier.cpp Match.cpp Error.cpp Record.cpp

# С использованием MSVC
cl /EHsc /std:c++17 /Fe:RecordClassifier.exe main.cpp Parser.cpp Validation.cpp Classifier.cpp Match.cpp Error.cpp Record.cpp
```

### Запуск программы

```bash
RecordClassifier.exe items.txt rules.txt output.txt
```

**Параметры командной строки:**

1. `items.txt` — файл с записями
2. `rules.txt` — файл с правилами классификации
3. `output.txt` — имя выходного файла для результатов

---

## Формат входных данных

### Файл records (items.txt)

Каждая запись описывается в формате:

```
<Имя_записи>: <свойство1> = [значения], <свойство2> = [значения], ...
```

**Правила:**

- Имя записи должно быть уникальным
- Имена свойств должны быть уникальными в пределах одной записи
- Значения свойств — целые числа в диапазоне `[-2147483648 ... 2147483647]`
- Значения указываются в квадратных скобках через запятую

**Пример:**

```
Car: color = [2], doors = [4], engine = [2000]
Bike: color = [3], wheels = [2]
Bus: color = [2, 3], doors = [2], seats = [40]
Truck: color = [1], doors = [2], wheels = [6], capacity = [5000]
```

### Файл rules (rules.txt)

Каждое правило описывается в формате:

```
<Имя_класса>: <условие>
```

**Поддерживаемые условия:**

1. **Наличие свойства:**

   ```
   Has doors: has property "doors"
   ```

2. **Количество значений:**

   ```
   Two wheels: property "wheels" has 2 values
   ```

3. **Наличие конкретного значения:**

   ```
   Red vehicle: property "color" contains value 2
   ```

4. **Полное совпадение массива:**
   ```
   Big bus: property "seats" = [40]
   ```

**Пример полного файла:**

```
Has doors: has property "doors"
Two wheels: property "wheels" has 2 values
Red vehicle: property "color" contains value 2
Blue vehicle: property "color" contains value 3
Big bus: property "seats" = [40]
Heavy truck: property "capacity" = [5000]
```

### Выходной файл (output.txt)

Формат результата:

```
<Имя_класса>: <Список_записей_через_запятую>
```

Если ни одна запись не соответствует классу, выводится символ `"-"`.

**Пример:**

```
Has doors: Car, Bus, Truck
Two wheels: Bike
Red vehicle: Car, Bus
Blue vehicle: Bike
Big bus: Bus
Heavy truck: Truck
```

---

## Примеры использования

### Пример 1: Классификация транспортных средств

**items.txt:**

```
Car: color = [2], doors = [4], engine = [2000]
Bike: color = [3], wheels = [2]
Bus: color = [2, 3], doors = [2], seats = [40]
```

**rules.txt:**

```
Has doors: has property "doors"
Two wheels: property "wheels" has 2 values
Red vehicle: property "color" contains value 2
Big bus: property "seats" = [40]
```

**Запуск:**

```bash
RecordClassifier.exe items.txt rules.txt output.txt
```

**Результат (output.txt):**

```
Has doors: Car, Bus
Two wheels: Bike
Red vehicle: Car, Bus
Big bus: Bus
```

### Пример 2: Классификация мебели

**items.txt:**

```
Wardrobe: color = [1, 2], size = [10, 20, 30], coating = [44]
Table: coating = [44], color = [5]
Chair: size = [5], color = [1]
Sofa: color = [2, 3], size = [15, 20]
```

**rules.txt:**

```
Blue furniture: property "color" contains value 1
With coating: has property "coating"
Voluminous: property "size" has 3 values
Matte: property "coating" = [44]
```

**Результат:**

```
Blue furniture: Wardrobe, Chair
With coating: Wardrobe, Table
Voluminous: Wardrobe
Matte: Wardrobe, Table
```

---

## Обработка ошибок

Программа выполняет комплексную проверку входных данных и выводит детальные сообщения об ошибках.

### Таблица ошибок

| Тип ошибки                      | Пример                              | Сообщение                                      |
| ------------------------------- | ----------------------------------- | ---------------------------------------------- |
| **Файл не найден**              | Отсутствует `items.txt`             | `Cannot open the file`                         |
| **Некорректное значение**       | `color = [1, a, 3]`                 | `Invalid value format in property list`        |
| **Дублирующееся свойство**      | `color=[1], color=[2]`              | `Duplicate property name "color" detected`     |
| **Пустое имя записи**           | `: color=[1]`                       | `No properties defined for record`             |
| **Пустой файл записей**         | Пустой `items.txt`                  | `No records found in input file`               |
| **Пустой файл правил**          | Пустой `rules.txt`                  | `No classes or rules found in input file`      |
| **Неверный формат правила**     | `Class: if "size" = number`         | `Invalid rule format`                          |
| **Несоответствие типов**        | `size = [1, "two"]`                 | `Type mismatch: expected integer values only`  |
| **Ошибка синтаксиса в записи**  | `Car: color [1, 2]`                 | `Syntax error in record definition`            |
| **Ошибка синтаксиса в правиле** | `Class: "coating"`                  | `Syntax error in class rule definition`        |
| **Незакрытая скобка**           | `Car: color = [1, 2, 3`             | `Syntax error: missing closing bracket`        |
| **Лишняя запятая**              | `Bike: wheels = [2,]`               | `Invalid value format: trailing comma`         |
| **Дублирующееся имя записи**    | Два `Car`                           | `Duplicate record name detected: Car`          |
| **Неизвестный тип правила**     | `property "speed" greater than 100` | `Unsupported rule type`                        |
| **Пустое имя класса**           | `: has property "doors"`            | `Class name missing in rule definition`        |
| **Пустое имя свойства**         | `has property ""`                   | `Invalid rule: property name cannot be empty`  |
| **Неверный разделитель**        | `Car - color = [1, 2]`              | `Syntax error: expected ':' after record name` |

### Поведение при ошибках

- При обнаружении ошибки программа **немедленно завершается**
- Выводится **детальное сообщение** с описанием проблемы
- Выходной файл `output.txt` **не создается**
- Код возврата: `1` (ошибка), `0` (успех)

---

## Тестирование

### Статистика тестирования

- **Всего тестов:** 45
- **Успешно пройдено:** 45
- **Провалено:** 0 
- **Покрытие кода:** ~95%

### Тестируемые функции

#### 1. parse_record_line (16 тестов)

Проверка разбора строк с записями:

- Корректные записи с различными свойствами
- Некорректные значения (не числа)
- Дублирующиеся свойства
- Пустые имена и свойства
- Незакрытые скобки и синтаксические ошибки
- Отрицательные числа
- Стресс-тесты (1000+ свойств)

#### 2. parse_class_line (16 тестов)

Проверка разбора правил классификации:

- Все типы правил (HAS_PROPERTY, PROPERTY_SIZE, CONTAINS_VALUE, EQUALS_EXACTLY)
- Некорректный формат правил
- Пустые имена классов
- Отсутствие кавычек и скобок
- Неизвестные типы правил

#### 3. validate_records (16 тестов)

Проверка валидации записей:

- Корректные и некорректные записи
- Пустой список записей
- Пустой список свойств
- Дублирующиеся имена
- Отрицательные значения
- Большое количество свойств (производительность)

#### 4. validate_classes (14 тестов)

Проверка валидации правил:

- Корректные правила
- Пустой список правил
- Неверный синтаксис
- Некорректные значения
- Пустые имена классов

#### 5. classify (9 тестов)

Проверка логики классификации:

- Запись соответствует одному правилу
- Запись соответствует нескольким правилам
- Несколько записей → разные классы
- Классы без совпадений
- Стресс-тесты (1000+ записей)

### Запуск тестов

```bash
# В Visual Studio
Test → Run All Tests

# Или через командную строку
vstest.console.exe FilteringRecordsTests.dll
```

---

## Документация

### Техническая документация

Проект включает полный комплект технической документации в соответствии с ГОСТ 19:

1. **Техническое задание** — требования к функциональности и надежности
2. **Внешняя спецификация** — описание интерфейсов и форматов данных
3. **Внутренняя спецификация** — описание структур данных и алгоритмов
4. **Программа и методика испытаний** — план тестирования и тест-кейсы
5. **Руководство программиста** — инструкции по установке и использованию

### Doxygen документация

Для генерации HTML-документации из комментариев кода:

```bash
doxygen Doxyfile
```

Документация будет создана в папке `docs/html/`.

---

## Алгоритм работы программы

```
1. Запуск программы
   ├─ Чтение параметров командной строки
   └─ Проверка наличия файлов

2. Парсинг входных данных
   ├─ Чтение items.txt → parse_record_line()
   ├─ Чтение rules.txt → parse_class_line()
   └─ Сохранение в структуры данных

3. Валидация данных
   ├─ Проверка записей → validate_records()
   ├─ Проверка правил → validate_classes()
   └─ Обработка ошибок → Error::print()

4. Классификация
   ├─ Сопоставление записей и правил → classify()
   └─ Формирование результатов

5. Вывод результатов
   ├─ Печать на экран
   ├─ Сохранение в output.txt (опционально)
   └─ Завершение программы (код возврата 0)
```

---

##  Ключевые функции

### Основные функции программы

| Функция               | Назначение                    | Возвращаемое значение         |
| --------------------- | ----------------------------- | ----------------------------- |
| `main()`              | Точка входа программы         | `int` (0 или 1)               |
| `parse_record_line()` | Разбор строки записи          | `bool`                        |
| `parse_class_line()`  | Разбор строки правила         | `bool`                        |
| `validate_records()`  | Проверка корректности записей | `DataCheckResult`             |
| `validate_classes()`  | Проверка корректности правил  | `DataCheckResult`             |
| `classify()`          | Классификация записей         | `map<string, vector<string>>` |
| `trim()`              | Удаление пробелов и табуляций | `string`                      |

### Вспомогательные функции

- `print_help()` — вывод справки о программе
- `print_results()` — форматированный вывод результатов
- `save_to_file()` — сохранение результатов в файл

---

## Информация о проекте

### Разработчик

- **Студент:** Алхабил Бахаа А.М.
- **Группа:** [ПрИн-468 ]

### Научный руководитель

- **Преподаватель:** доц. Сычев О.А.

### Учебная дисциплина

- **Курс:** Качество и надёжность программного обеспечения
- **Университет:** Волгоградский государственный технический университет (ВолгГТУ)
- **Год:** 2025

---

## Лицензия

Данный проект разработан в учебных целях.  
© 2025 Алхабил Бахаа А.М., Волгоградский государственный технический университет

---
